:PROPERTIES:
:ID:       3dc5b2a5-0b30-4d53-a7ff-1e219a36207d
:END:
#+title: js-tool-gulp
#+date: [2024-10-06 周日]
#+last_modified:  



|-----------------------------+--------------------------------------+-------+-----------------------------------------------------------+---|
| API                         | Params                               | Ret   | Note                                                      |   |
|-----------------------------+--------------------------------------+-------+-----------------------------------------------------------+---|
| gulp.task()                 | "name",                              |       |                                                           |   |
|                             | [deps:Array]                         |       | deps ref to name of other task that is deped by this task |   |
|                             | CB:()=>nil                           |       |                                                           |   |
|-----------------------------+--------------------------------------+-------+-----------------------------------------------------------+---|
| <<if task want exec async>> |                                      |       |                                                           |   |
|-----------------------------+--------------------------------------+-------+-----------------------------------------------------------+---|
|                             | CB must end with a call to cb()      |       |                                                           |   |
|-----------------------------+--------------------------------------+-------+-----------------------------------------------------------+---|
|                             | or                                   |       |                                                           |   |
|                             | return a stream(usually a gulp pipe) |       |                                                           |   |
|-----------------------------+--------------------------------------+-------+-----------------------------------------------------------+---|
|                             | or                                   |       |                                                           |   |
|                             | a [[id:ac7a56ae-8a08-4beb-9082-9feda91bbd5f][js-Promise]]                         |       |                                                           |   |
|-----------------------------+--------------------------------------+-------+-----------------------------------------------------------+---|
| gulp.src()                  | file_patt;str                        |       |                                                           |   |
|                             | [[task.options]]={}                      |       |                                                           |   |
|-----------------------------+--------------------------------------+-------+-----------------------------------------------------------+---|
| pipe.pipe()                 | fn                                   |       | process function                                          |   |
|-----------------------------+--------------------------------------+-------+-----------------------------------------------------------+---|
| globs                       | string/Array                         |       |                                                           |   |
|-----------------------------+--------------------------------------+-------+-----------------------------------------------------------+---|
| <<task.options>>            | Object                               |       |                                                           |   |
|-----------------------------+--------------------------------------+-------+-----------------------------------------------------------+---|
| options.buffer              | bool=true                            |       |                                                           |   |
|-----------------------------+--------------------------------------+-------+-----------------------------------------------------------+---|
| options.read                | bool=true                            |       | if file can be read                                       |   |
|-----------------------------+--------------------------------------+-------+-----------------------------------------------------------+---|
| options.base                | str                                  |       | wil prepend to file_patt                                  |   |
|                             |                                      |       | to put target files                                       |   |
|                             |                                      |       | default base is dir before fist waildcard                 |   |
|                             |                                      |       | e.g. 'client/js/**/*/js', base is 'client/js'             |   |
|-----------------------------+--------------------------------------+-------+-----------------------------------------------------------+---|
| gulp.watch()                | patt:str                             | [str] |                                                           |   |
|                             | [opts]                               |       |                                                           |   |
|                             | tasks:[str]                          |       |                                                           |   |
|-----------------------------+--------------------------------------+-------+-----------------------------------------------------------+---|
|                             | patt:str                             |       |                                                           |   |
|                             | [opts]                               |       |                                                           |   |
|                             | CB([[Event]])                            |       | call CB when eachtime file chaged                         |   |
|-----------------------------+--------------------------------------+-------+-----------------------------------------------------------+---|
| <<Event>>                   |                                      |       |                                                           |   |
|-----------------------------+--------------------------------------+-------+-----------------------------------------------------------+---|
| event.path                  | str                                  |       |                                                           |   |
|-----------------------------+--------------------------------------+-------+-----------------------------------------------------------+---|
| event.type                  | added, changed or deleted            |       |                                                           |   |
|-----------------------------+--------------------------------------+-------+-----------------------------------------------------------+---|
|                             |                                      |       |                                                           |   |



#+NAME: process func
| Fun              | Params               | Ret | Note                                             |
|------------------+----------------------+-----+--------------------------------------------------|
| gulp.dest()      | dir:str              |     | put file in pipe to dest dir                     |
|                  |                      |     | dir will be auto created.                        |
|                  |                      |     | this is pure function,                           |
|                  | [[dest.options]]={}      |     | and you can call it in pipe again to another dir |
|------------------+----------------------+-----+--------------------------------------------------|
|                  | dir:Function         |     | ret of function will work as dir path            |
|------------------+----------------------+-----+--------------------------------------------------|
| <<dest.options>> |                      |     |                                                  |
|------------------+----------------------+-----+--------------------------------------------------|
| options.cwd      | string=process.cwd() |     |                                                  |
|------------------+----------------------+-----+--------------------------------------------------|
| options.mode     | string=0777          |     |                                                  |
|------------------+----------------------+-----+--------------------------------------------------|
|                  |                      |     |                                                  |
|------------------+----------------------+-----+--------------------------------------------------|
|                  |                      |     |                                                  |


#+NAME plugins

|----------------------+-------------+-------------------------+---------------------------------|
| API                  | PARAMS      | RET                     | NOTE                            |
|----------------------+-------------+-------------------------+---------------------------------|
|                      |             |                         |                                 |
|----------------------+-------------+-------------------------+---------------------------------|
| <<stream-combiner2>> |             |                         |                                 |
| combiner.obj()       | [pile node] | gulp pipe               |                                 |
|----------------------+-------------+-------------------------+---------------------------------|
| combiner.on()        | name:str    |                         |                                 |
|                      |             |                         |                                 |
|----------------------+-------------+-------------------------+---------------------------------|
| <<gulp-typescript>>  |             |                         |                                 |
|----------------------+-------------+-------------------------+---------------------------------|
| ts.createProject()   | cfg:str     | tsProject:gulp pipe     | path of tsconfig.json           |
|----------------------+-------------+-------------------------+---------------------------------|
| <<del>>              | node module |                         |                                 |
|----------------------+-------------+-------------------------+---------------------------------|
| del()                | patt:[str]  |                         |                                 |
|                      | CB          |                         |                                 |
|----------------------+-------------+-------------------------+---------------------------------|
| <<vinyl-paths>>      |             |                         | get path of every files in pipe |
|                      |             |                         | and convert to cb               |
|----------------------+-------------+-------------------------+---------------------------------|
| vinyPaths            | cb:Function |                         |                                 |
|----------------------+-------------+-------------------------+---------------------------------|
| <<gulp-uglify>>      |             |                         |                                 |
|----------------------+-------------+-------------------------+---------------------------------|
| uplify()             |             |                         | compress js css files           |
|----------------------+-------------+-------------------------+---------------------------------|
| <<gulp-if>>          |             |                         |                                 |
|----------------------+-------------+-------------------------+---------------------------------|
| gulpif()             | expr:bool   | if expr is true call CB |                                 |
|                      | cb          | or do nothing           |                                 |
|----------------------+-------------+-------------------------+---------------------------------|
|                      |             |                         |                                 |
|----------------------+-------------+-------------------------+---------------------------------|
|                      |             |                         |                                 |
